<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>EduPass | School Records</title>
	<link rel='icon' type='image/svg+xml' href='logo.svg'>
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,400i,500,500i|Roboto+Condensed:400,700' rel='stylesheet'>
	<link rel='stylesheet' type='text/css' media='screen' href='../common.css'>
	<link rel='stylesheet' type='text/css' media='screen' href='../layout.css'>
	<style>
		#comptitions-parent {
			float: left;
			width: 500px;
		}
		.competition {
    		width: 500px;
			border: 1px solid #212121;
			padding: 6px;
			margin-bottom: 6px;
			border-radius: 6px;
			cursor: pointer;
			display: flex;
			align-items: center;
		}
		.competition img {
			min-width: 50px;
			margin-right: 8px;
			display: block;
			border-radius: 3px;
		}
		.competition div {
			flex-grow: 1;
		}
		#aptitude-chart-parent {
			width: calc(100% - 500px);
			float: left;
		}
		section:after {
			content: '';
			clear: both;
		}
	</style>
	<link rel='stylesheet' type='text/css' href='../themes/messages/dark_theme.css'>
</head>
<body>
	<nav>
		<a href='messages.html'><img src='../assets/icons/messages.svg'>Messages</a>
		<a href='records.html'><img src='../assets/icons/records.svg'>Records</a>
		<a href='counseling.html'><img src='../assets/icons/counseling.svg'>Counseling</a>
		<a href="../index.html"><img src='../assets/icons/back-arrow.svg'>Return</a>
	</nav>
	<main>
		<h1>School Records</h1>
		<section id='badges-aptitudes'>
			<h2>Badges & Aptitude</h2>
			<div id='comptitions-parent'></div>
			<div id='aptitude-chart-parent'><canvas id='aptitude-chart'></canvas></div>
		</section>
	</main>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script>
		const COMPETITIONS = [
			{
				name: 'Build On, Singapore',
				badge: 'alastor.jpg',
				tags: {
					science: 2,
					infocomm: 2,
					innovation: 2
				}
			},
			{
				name: 'Singapore Math Olympiad 2019',
				badge: 'alastor.jpg',
				tags: {
					science: 2,
					math: 2
				}
			},
			{
				name: 'SGCC 2019',
				badge: 'alastor.jpg',
				tags: {
					science: 2,
					infocomm: 2,
					innovation: 2
				}
			},
			{
				name: 'Singapore Math Olympiad 2018',
				badge: 'alastor.jpg',
				tags: {
					science: 2,
					math: 2
				}
			},
			{
				name: 'Pie Baking Competition 2018',
				badge: 'alastor.jpg',
				tags: {
					uselessness: 50
				}
			}
		];
		let tags = {};
		document.addEventListener('DOMContentLoaded', () => {
			const COMPETITIONS_PARENT = document.getElementById('comptitions-parent');
			COMPETITIONS.forEach(competition => {
				const PARENT = document.createElement('div');
				const BADGE = document.createElement('img');
				const NAME = document.createElement('div');
				PARENT.classList.add('competition');

				// change to s3 in future
				BADGE.src = `../assets/icons/${competition.badge}`;
				BADGE.width = 50;
				NAME.appendChild(document.createTextNode(competition.name));
				PARENT.appendChild(BADGE);
				PARENT.appendChild(NAME);
				COMPETITIONS_PARENT.appendChild(PARENT);

				for (const TAG of Object.keys(competition.tags)) {
					if (tags[TAG]) tags[TAG] += competition.tags[TAG];
					else tags[TAG] = competition.tags[TAG];
				}
			});
			let backgroundColors = [];
			let hoverBackgroundColors = [];
			for (let i = Object.keys(tags).length - 1; i >= 0; i -= 1) {
				const HS = `hsl(${360 * Math.random()}, ${50 + 30 * Math.random()}%,`;
				const L = 70 + 20 * Math.random();
				backgroundColors.push(`${HS} ${L}%)`);
				hoverBackgroundColors.push(`${HS} ${L - 10}%`);
			}
			const CHART = new Chart('aptitude-chart', {
				type: 'doughnut',
				data: {
					labels: Object.keys(tags),
					datasets: [{
						label: 'Aptitude',
						data: Object.values(tags),
						backgroundColor: backgroundColors,
						hoverBackgroundColor: hoverBackgroundColors
					}]
				},
				options: {
					cutoutPercentage: 60,
					legend: {
						boxWidth: 30,
						position: 'right',
						labels: {
							fontSize: 20,
							fontFamily: "Roboto, sans-serif"
						}
					},
					title: {
						display: true,
						fontSize: 36,
						fontFamily: "'Roboto Condensed', 'Roboto', sans-serif",
						text: 'Your Aptitude'
					},
					tooltips: {
						bodyFontFamily: "Roboto, sans-serif",
						bodyFontSize: 20
					}
				}
			});
		});
	</script>
</body>
</html>